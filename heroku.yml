             # Resources to provision on app creation
setup:
  addons:
    - plan: heroku-postgresql
      as: db
    - plan: heroku-redis
      as: reddis
# Reference the Dockerfiles to build into Docker images
build:
  docker:
    web: Dockerfile
    celery: Dockerfile
    celery-beat: Dockerfile
  config:
    PROJECT_DIR: /home/hoker-newz
  image: web
    command:
      - ./entrypoint-heroku.sh


  # Run a command on each release
run:
  web: cd ${PROJECT_DIR} && gunicorn --pythonpath '${PROJECT_DIR}/' hoker_newz.wsgi:application
  celery: cd ${PROJECT_DIR} && celery -A hoker_newz worker
  celery-beat: cd ${PROJECT_DIR} && celery -A hoker_newz beat